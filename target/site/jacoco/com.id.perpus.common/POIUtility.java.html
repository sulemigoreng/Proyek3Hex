<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>POIUtility.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">PerpustakaanWebApp</a> &gt; <a href="index.source.html" class="el_package">com.id.perpus.common</a> &gt; <span class="el_source">POIUtility.java</span></div><h1>POIUtility.java</h1><pre class="source lang-java linenums">package com.id.perpus.common;

import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.text.DecimalFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;
import java.util.Properties;
import java.util.StringTokenizer;

import javax.servlet.ServletOutputStream;
import javax.servlet.http.HttpServletResponse;

import org.apache.poi.hssf.usermodel.HSSFCell;
import org.apache.poi.hssf.usermodel.HSSFCellStyle;
import org.apache.poi.hssf.usermodel.HSSFRow;
import org.apache.poi.hssf.usermodel.HSSFSheet;
import org.apache.poi.hssf.usermodel.HSSFWorkbook;
import org.apache.poi.poifs.filesystem.POIFSFileSystem;

<span class="nc" id="L23">public class POIUtility {</span>
	/**
	 * Prepate excel template file.
	 * @param fileName the template file.
	 * @return workbook
	 * @throws IOException
	 */
    @SuppressWarnings(&quot;unused&quot;)
	public static HSSFWorkbook prepareTemplate(String fileName) throws IOException {
        HSSFWorkbook wb;        
<span class="nc" id="L33">        String[] arFileName = split(fileName, &quot;.&quot;);</span>
<span class="nc" id="L34">        String stFileName = arFileName[0];</span>
<span class="nc" id="L35">        stFileName += '.' + arFileName[1];</span>
<span class="nc" id="L36">        POIFSFileSystem fs = new POIFSFileSystem(new FileInputStream(fileName));</span>
<span class="nc" id="L37">        wb = new HSSFWorkbook(fs);</span>
<span class="nc" id="L38">        return wb;</span>
    }
    
    public static String[] split(String str, String delim) {
<span class="nc" id="L42">		StringTokenizer st = new StringTokenizer(str, delim);</span>
<span class="nc" id="L43">		String[] arStr = new String[st.countTokens()];</span>
<span class="nc bnc" id="L44" title="All 2 branches missed.">		for (int i = 0; st.hasMoreTokens(); i++)</span>
<span class="nc" id="L45">			arStr[i] = st.nextToken();</span>
<span class="nc" id="L46">		return arStr;</span>
	}
    
    /**
     * Prepare excel template file.
     * @param isStream the stream template.
     * @return workbook.
     * @throws IOException
     */
    public static HSSFWorkbook prepareTemplate(InputStream isStream) throws IOException {
        HSSFWorkbook wb;        
<span class="nc" id="L57">        POIFSFileSystem fs = new POIFSFileSystem(isStream);</span>
<span class="nc" id="L58">        wb = new HSSFWorkbook(fs);</span>
<span class="nc" id="L59">        return wb;</span>
    }    
    
    /**
     * Return the specified cell.
     * @param sheet the worksheet.
     * @param intRow the row.
     * @param intCol the column.
     * @return the specified cell.
     */
    public static HSSFCell getCell(HSSFSheet sheet, int intRow, int intCol) {
<span class="nc" id="L70">        HSSFRow row = sheet.getRow(intRow);</span>
        
<span class="nc bnc" id="L72" title="All 2 branches missed.">        if (row==null) return null;</span>
<span class="nc" id="L73">        HSSFCell cell = row.getCell((short)intCol);</span>
                            
<span class="nc bnc" id="L75" title="All 2 branches missed.">        if (cell == null) cell = row.createCell((short) intCol);</span>
<span class="nc" id="L76">        return cell;</span>
    }

    /**
     * Add by Irwan Wijaya
     * @param sheet the worksheet.
     * @param intRow the row.
     * @param intCol the column. 
     * @param isString is flag to indicated that the cell in Excel file is String.
     * if isString = yes then it will convert to exactly String
     * if isString = no then it will get the value from Excel (return exponen number)
     * Add new checking to allow get input Formula from Excel File.
     */    
    @SuppressWarnings(&quot;deprecation&quot;)
	public static String getCellString(HSSFSheet sheet, int intRow, int intCol, boolean isString) {
        
<span class="nc" id="L92">        String stValue = &quot;&quot;;</span>
<span class="nc" id="L93">        HSSFCell cell = getCell(sheet, intRow, intCol);</span>
<span class="nc bnc" id="L94" title="All 2 branches missed.">        if (cell==null) return &quot;&quot;;</span>
        else {            
<span class="nc bnc" id="L96" title="All 2 branches missed.">	        if (cell.getCellType() == HSSFCell.CELL_TYPE_STRING) {</span>
<span class="nc" id="L97">	            stValue = cell.getStringCellValue();</span>
<span class="nc bnc" id="L98" title="All 2 branches missed.">	        } else if (cell.getCellType() == HSSFCell.CELL_TYPE_NUMERIC) {</span>
<span class="nc bnc" id="L99" title="All 2 branches missed.">	            if  (isString) {</span>
<span class="nc" id="L100">	                stValue = formatDoubleToString(new Double (cell.getNumericCellValue()),&quot;###&quot;);</span>
<span class="nc" id="L101">	            }</span>
	            else {
<span class="nc" id="L103">	                stValue = Double.toString(cell.getNumericCellValue());    </span>
	            }	                
<span class="nc bnc" id="L105" title="All 2 branches missed.">	        } else if (cell.getCellType() == HSSFCell.CELL_TYPE_BOOLEAN) {</span>
<span class="nc" id="L106">	            stValue = Boolean.toString(cell.getBooleanCellValue());</span>
<span class="nc bnc" id="L107" title="All 2 branches missed.">	        } else if (cell.getCellType() == HSSFCell.CELL_TYPE_BLANK) {</span>
<span class="nc" id="L108">	            stValue = &quot;&quot;;</span>
<span class="nc bnc" id="L109" title="All 2 branches missed.">	        } else if (cell.getCellType() == HSSFCell.CELL_TYPE_FORMULA) {</span>
<span class="nc" id="L110">	            stValue = Double.toString(cell.getNumericCellValue());</span>
	        }
<span class="nc" id="L112">	        return stValue;</span>
        }
    }
    
    
    public static String formatDoubleToString(Double dbValue, String stFormat) {
<span class="nc" id="L118">    	DecimalFormat df = new DecimalFormat(&quot;###,###.##############&quot;);	</span>
    	
    	String stReturn;
<span class="nc" id="L121">        synchronized (df) {</span>
<span class="nc" id="L122">            df.applyPattern(stFormat); </span>
<span class="nc bnc" id="L123" title="All 2 branches missed.">            stReturn = dbValue == null ? &quot;&quot; : df.format(dbValue);</span>
<span class="nc" id="L124">            df.applyPattern(&quot;###,###.##############&quot;);</span>
        }
<span class="nc" id="L126">        return stReturn;</span>
    }
    
    /**
     * give cell value in double type.
     * @param sheet the worksheet.
     * @param intRow the row.
     * @param intCol the column.
     * @return cell value in double type.
     */
    @SuppressWarnings(&quot;deprecation&quot;)
	public static double getCellDouble(HSSFSheet sheet, int intRow, int intCol) {
<span class="nc" id="L138">        double dblValue = 0;</span>
        try {
<span class="nc" id="L140">            HSSFRow row = sheet.getRow(intRow);</span>
<span class="nc" id="L141">            HSSFCell cell = row.getCell((short) intCol);</span>
<span class="nc bnc" id="L142" title="All 2 branches missed.">            if (cell == null) {</span>
<span class="nc" id="L143">                return 0;</span>
            }
<span class="nc bnc" id="L145" title="All 2 branches missed.">            if (cell.getCellType() == HSSFCell.CELL_TYPE_STRING) {</span>
<span class="nc bnc" id="L146" title="All 2 branches missed.">                if (isInteger(cell.getStringCellValue())) { </span>
<span class="nc" id="L147">                    dblValue = Double.parseDouble(cell.getStringCellValue());</span>
                }
<span class="nc bnc" id="L149" title="All 2 branches missed.">            } else if (cell.getCellType() == HSSFCell.CELL_TYPE_NUMERIC) {</span>
<span class="nc" id="L150">                dblValue = cell.getNumericCellValue();</span>
            }
<span class="nc" id="L152">        } catch (Exception e) {</span>
<span class="nc" id="L153">            dblValue = 0;</span>
        }        
<span class="nc" id="L155">        return dblValue;</span>
    }
    
    public static boolean isInteger(String s) {
        try {
<span class="nc" id="L160">            Integer.parseInt(s);</span>
<span class="nc" id="L161">        } catch (NumberFormatException e) {</span>
<span class="nc" id="L162">            return false;</span>
        }

<span class="nc" id="L165">        return true;</span>
    }
    
    
    public static String getWEBINFPath(){
<span class="nc" id="L170">    	String stWebInf=&quot;&quot;;    	</span>
<span class="nc" id="L171">    	Properties prop = System.getProperties();</span>
<span class="nc" id="L172">    	prop.list(System.out);               </span>
<span class="nc" id="L173">        System.out.println(System.getProperty(&quot;sun.boot.class.path&quot;));</span>
<span class="nc" id="L174">        System.out.println(System.getProperty(&quot;was.install.root&quot;));</span>
<span class="nc" id="L175">        System.out.println(System.getProperty(&quot;db2j.system.home&quot;));</span>
<span class="nc" id="L176">        System.out.println(System.getProperty(&quot;was.repository.temp&quot;));</span>
<span class="nc" id="L177">        System.out.println(System.getProperty(&quot;sun.boot.library.path&quot;));</span>
<span class="nc" id="L178">        System.out.println(System.getProperty(&quot;sun.boot.library.path&quot;));</span>
<span class="nc" id="L179">        System.out.println(System.getProperty(&quot;server.root&quot;));</span>
<span class="nc" id="L180">        System.out.println(System.getProperty(&quot;java.home&quot;));</span>
<span class="nc" id="L181">        System.out.println(System.getProperty(&quot;java.security.policy&quot;));</span>
<span class="nc" id="L182">        System.out.println(System.getProperty(&quot;was.repository.root&quot;));</span>
<span class="nc" id="L183">        System.out.println(System.getProperty(&quot;java.library.path&quot;));        </span>
<span class="nc" id="L184">        System.out.println(System.getProperty(&quot;ws.ext.dirs&quot;));</span>
<span class="nc" id="L185">        System.out.println(System.getProperty(&quot;java.io.tmpdir&quot;));</span>
<span class="nc" id="L186">        System.out.println(System.getProperty(&quot;java.ext.dirs&quot;));</span>
<span class="nc" id="L187">        System.out.println(System.getProperty(&quot;user.dir&quot;));</span>
<span class="nc" id="L188">        System.out.println(System.getProperty(&quot;user.install.root&quot;));</span>
        //System.out.println(System.getProperty(&quot;com.ibm.itp.location&quot;));
<span class="nc" id="L190">        System.out.println(System.getProperty(&quot;com.ibm.oti.system.class.path&quot;));</span>
<span class="nc" id="L191">        System.out.println(System.getProperty(&quot;java.security.auth.login.config&quot;));        </span>
<span class="nc" id="L192">    	return stWebInf;</span>
    }
    
    /**
     * To replace the new value for parameter array.
     * @param temp the array.
     * @param newValue the new value for temp[temp.length-1].
     * @param Counter the length of temp.
     * @return new array contain newValue.
     */
    @SuppressWarnings(&quot;unused&quot;)
	private static String[] newArr(String[] temp, String newValue, int Counter) {    	
<span class="nc" id="L204">        String[] tmpVal = new String[Counter];</span>
<span class="nc" id="L205">        System.arraycopy(temp, 0, tmpVal, 0, temp.length);</span>
<span class="nc" id="L206">        temp = tmpVal;</span>
<span class="nc" id="L207">        temp[Counter - 1] = newValue;</span>
<span class="nc" id="L208">        return temp;</span>
    }
    
    
    
    /**
     * split a string to array.
     * @param s the parameter string to be splitted.
     * @param sep the separator.
     * @return an array of string.
     */
    @SuppressWarnings(&quot;unused&quot;)
	private static String[] Split2Array(String s, String sep) {
<span class="nc" id="L221">        StringBuffer buf = new StringBuffer(s);</span>
<span class="nc" id="L222">        int arraysize = 1;</span>
<span class="nc bnc" id="L223" title="All 2 branches missed.">        for (int i = 0; i &lt; buf.length(); i++) {</span>
<span class="nc bnc" id="L224" title="All 2 branches missed.">            if (sep.indexOf(buf.charAt(i)) != -1)</span>
<span class="nc" id="L225">                arraysize++;</span>
        }
<span class="nc" id="L227">        String[] elements = new String[arraysize];</span>
<span class="nc" id="L228">        int y, z = 0;</span>
<span class="nc bnc" id="L229" title="All 2 branches missed.">        if (buf.toString().indexOf(sep) != -1) {</span>
<span class="nc bnc" id="L230" title="All 2 branches missed.">            while (buf.length() &gt; 0) {</span>
<span class="nc bnc" id="L231" title="All 2 branches missed.">                if (buf.toString().indexOf(sep) != -1) {</span>
<span class="nc" id="L232">                    y = buf.toString().indexOf(sep);</span>
<span class="nc bnc" id="L233" title="All 2 branches missed.">                    if (y != buf.toString().lastIndexOf(sep)) {</span>
<span class="nc" id="L234">                        elements[z] = buf.toString().substring(0, y);</span>
<span class="nc" id="L235">                        z++;</span>
<span class="nc" id="L236">                        buf.delete(0, y + 1);</span>
<span class="nc bnc" id="L237" title="All 2 branches missed.">                    } else if (buf.toString().lastIndexOf(sep) == y) {</span>
<span class="nc" id="L238">                        elements[z] = buf.toString().substring(0, buf.toString().indexOf(sep));</span>
<span class="nc" id="L239">                        z++;</span>
<span class="nc" id="L240">                        buf.delete(0, buf.toString().indexOf(sep) + 1);</span>
<span class="nc" id="L241">                        elements[z] = buf.toString();</span>
<span class="nc" id="L242">                        z++;</span>
<span class="nc" id="L243">                        buf.delete(0, buf.length());</span>
                    }
                }
            }
<span class="nc" id="L247">        } else {</span>
<span class="nc" id="L248">            elements[0] = buf.toString();</span>
        }
<span class="nc" id="L250">        buf = null;</span>
<span class="nc" id="L251">        return elements;</span>
    }
    
     /**
      * copy a row to another row.
      * @param sheet the worksheet.
      * @param source row source.
      * @param dest row destination.
      */
     public static void copyRow(HSSFSheet sheet, int source, int dest) {
<span class="nc" id="L261">        copyRow(sheet, source, dest, false);</span>
<span class="nc" id="L262">     }</span>

     /**
      * copy a row to another row.
      * @param sheet the worksheet.
      * @param source row source.
      * @param dest row destination.
      * @param blSameHeight flag whether destination row will be set the same height.
      */
     @SuppressWarnings(&quot;deprecation&quot;)
	public static void copyRow(HSSFSheet sheet, int source, int dest, boolean blSameHeight) {

<span class="nc" id="L274">         HSSFRow rowSource = sheet.getRow(source);</span>
<span class="nc" id="L275">         HSSFRow rowDest = sheet.createRow(dest);</span>

<span class="nc bnc" id="L277" title="All 2 branches missed.">         for (short col=0; col&lt;=rowSource.getLastCellNum(); col++) {</span>
<span class="nc" id="L278">             HSSFCell cellSource = rowSource.getCell(col);</span>
<span class="nc" id="L279">             HSSFCell cellDest = rowDest.createCell(col);</span>

<span class="nc bnc" id="L281" title="All 2 branches missed.">             if (cellSource != null)</span>
             {
<span class="nc" id="L283">                 int cellType = cellSource.getCellType();</span>

<span class="nc bnc" id="L285" title="All 3 branches missed.">                 switch (cellType) {</span>
                     case HSSFCell.CELL_TYPE_STRING :
<span class="nc" id="L287">                         cellDest.setCellValue(cellSource.getStringCellValue());</span>
<span class="nc" id="L288">                         break;</span>
                     case HSSFCell.CELL_TYPE_NUMERIC :
<span class="nc" id="L290">                         cellDest.setCellValue(cellSource.getNumericCellValue());</span>
<span class="nc" id="L291">                         break;</span>
                     default :
                         break;
                 }
<span class="nc" id="L295">                 cellDest.setCellStyle(cellSource.getCellStyle());</span>
             }
         }
<span class="nc bnc" id="L298" title="All 2 branches missed.">         if (blSameHeight) {</span>
<span class="nc" id="L299">             rowDest.setHeightInPoints(rowSource.getHeightInPoints());</span>
         }

<span class="nc" id="L302">     }</span>

     /**
      * copy a row to another row.
      * @param sheet the worksheet.
      * @param source row source.
      * @param dest row destination.
      */
     public static void copyCell(HSSFSheet sheet, int rowSource, int colSource, int rowDest, int ColDest) {
<span class="nc" id="L311">        copyCell(sheet, rowSource, colSource,rowDest, ColDest, false);</span>
<span class="nc" id="L312">     }</span>

     /**
      * copy a row to another row.
      * @param sheet the worksheet.
      * @param source row source.
      * @param dest row destination.
      * @param blSameHeight flag whether destination row will be set the same height.
      */
     @SuppressWarnings(&quot;deprecation&quot;)
	public static void copyCell(HSSFSheet sheet, int rowSource, int colSource, int rowDest, int ColDest, boolean blSameHeight) {

<span class="nc" id="L324">         HSSFRow rowSourceData = sheet.getRow(rowSource);</span>
<span class="nc" id="L325">         HSSFRow rowDestData = sheet.getRow(rowDest);</span>
<span class="nc" id="L326">         HSSFCell cellSource = rowSourceData.getCell((short)colSource);</span>
<span class="nc" id="L327">         HSSFCell cellDest = rowSourceData.createCell((short)ColDest);</span>

<span class="nc bnc" id="L329" title="All 2 branches missed.">             if (cellSource != null)</span>
             {
<span class="nc" id="L331">                 int cellType = cellSource.getCellType();</span>

<span class="nc bnc" id="L333" title="All 3 branches missed.">                 switch (cellType) {</span>
                     case HSSFCell.CELL_TYPE_STRING :
<span class="nc" id="L335">                         cellDest.setCellValue(cellSource.getStringCellValue());</span>
<span class="nc" id="L336">                         break;</span>
                     case HSSFCell.CELL_TYPE_NUMERIC :
<span class="nc" id="L338">                         cellDest.setCellValue(cellSource.getNumericCellValue());</span>
<span class="nc" id="L339">                         break;</span>
                     default :
                         break;
                 }
<span class="nc" id="L343">                 cellDest.setCellStyle(cellSource.getCellStyle());</span>
             }
         
<span class="nc bnc" id="L346" title="All 2 branches missed.">         if (blSameHeight) {</span>
<span class="nc" id="L347">             rowDestData.setHeightInPoints(rowSourceData.getHeightInPoints());</span>
         }

<span class="nc" id="L350">     }</span>
     /**
      * Create a new cell.
      * @param sheet the worksheet.
      * @param intRow the row.
      * @param intCol the column.
      * @return new cell.
      */
     private static HSSFCell createCell(HSSFSheet sheet, int intRow, int intCol) {
<span class="nc" id="L359">         HSSFRow row = sheet.getRow(intRow);</span>
<span class="nc bnc" id="L360" title="All 2 branches missed.">         if (row==null) row = sheet.createRow(intRow);</span>
<span class="nc" id="L361">         HSSFCell cell = row.getCell((short)intCol);</span>
<span class="nc bnc" id="L362" title="All 2 branches missed.">         if (cell==null) cell = row.createCell((short)intCol);</span>
<span class="nc" id="L363">         return cell;</span>
     }
     
     /**
      * Set cell value with a string.
      * @param sheet the worksheet.
      * @param row the row.
      * @param col the column.
      * @param text the cell value.
      */
     public static void setText(HSSFSheet sheet, int row, int col, String text) {
<span class="nc" id="L374">         HSSFCell cell = createCell(sheet, row, col);</span>
<span class="nc" id="L375">         cell.setCellValue(text);</span>
<span class="nc" id="L376">     }</span>

     /**
      * Set cell value with an integer.
      * @param sheet the worksheet.
      * @param row the row.
      * @param col the column.
      * @param value the cell value.
      */
     public static void setInt(HSSFSheet sheet, int row, int col, int value) {
<span class="nc" id="L386">         HSSFCell cell = createCell(sheet, row, col);</span>
<span class="nc" id="L387">         cell.setCellValue(value);</span>
<span class="nc" id="L388">     }</span>

     /**
      * Set cell value with a date.
      * @param sheet the worksheet.
      * @param row the row.
      * @param col the column.
      * @param date the cell value.
      */
     public static void setDate(HSSFSheet sheet, int row, int col, java.util.Date date) {
<span class="nc" id="L398">         HSSFCell cell = createCell(sheet, row, col);</span>
<span class="nc bnc" id="L399" title="All 2 branches missed.">         if (date==null) cell.setCellValue(&quot;&quot;);</span>
<span class="nc" id="L400">         else cell.setCellValue(date);</span>
<span class="nc" id="L401">     }</span>

     /**
      * Write workbook via HttpServletResponse.
      * @param report the workbook.
      * @param response the HttpServletResponse
      * @param stFileName the file name.
      * @throws IOException
      */
     public static void writeToResponse(HSSFWorkbook report, HttpServletResponse response, String stFileName)
             throws IOException {
<span class="nc" id="L412">         response.setContentType(&quot;application/vnd.ms-excel&quot;);</span>
<span class="nc" id="L413">         String currentDate = &quot;&quot;;</span>
<span class="nc" id="L414">         stFileName = stFileName + currentDate + &quot;.xls&quot;;</span>
<span class="nc" id="L415">         response.setHeader(&quot;Content-Disposition&quot;, &quot;attachment;filename=&quot; + stFileName);</span>
<span class="nc" id="L416">         ServletOutputStream fileOut = response.getOutputStream();</span>
<span class="nc" id="L417">         report.write(fileOut);</span>
<span class="nc" id="L418">         fileOut.flush();</span>
<span class="nc" id="L419">     }</span>

     /**
      * Set cell value.
      * @param sheet the worksheet.
      * @param row the row.
      * @param col the column.
      * @param obj the value of cell.
      */
     public static void setObject(HSSFSheet sheet, int row, int col, Object obj) {
<span class="nc" id="L429">         HSSFCell cell = createCell(sheet, row, col);</span>
<span class="nc bnc" id="L430" title="All 2 branches missed.">         if (obj==null) cell.setCellValue(&quot;&quot;);</span>
<span class="nc bnc" id="L431" title="All 2 branches missed.">         else if (obj instanceof String)</span>
<span class="nc" id="L432">             cell.setCellValue((String)obj);</span>
         //else if (obj instanceof Number)
             //cell.setCellValue(((Number)obj).intValue());
<span class="nc bnc" id="L435" title="All 2 branches missed.">         else if (obj instanceof Number)</span>
<span class="nc" id="L436">             cell.setCellValue(((Number)obj).doubleValue());</span>
<span class="nc bnc" id="L437" title="All 2 branches missed.">         else if (obj instanceof Date)</span>
<span class="nc" id="L438">             cell.setCellValue((Date)obj);</span>
<span class="nc" id="L439">     }</span>
     
     /**
      * Get the list of column names.
      * @param sheet the worksheet.
      * @param intRow the row.
      * @param startCol the starting column.
      * @return list of column names.
      */
     @SuppressWarnings({ &quot;rawtypes&quot;, &quot;unchecked&quot; })
	public static List getColNames(HSSFSheet sheet, int intRow, int startCol) {
<span class="nc" id="L450">         List colNames = new ArrayList();</span>
<span class="nc" id="L451">         HSSFRow row = sheet.getRow(intRow-1);</span>
<span class="nc bnc" id="L452" title="All 2 branches missed.">         for (short col = (short)(startCol-1); col &lt; row.getLastCellNum(); col++) {</span>
<span class="nc" id="L453">             HSSFCell cell = row.getCell(col);</span>
<span class="nc bnc" id="L454" title="All 2 branches missed.">             if (cell==null) break;</span>
<span class="nc" id="L455">             String colName = row.getCell(col).getStringCellValue();</span>
<span class="nc bnc" id="L456" title="All 4 branches missed.">             if (colName == null || colName.trim().equals( &quot;&quot; ) ) break;</span>
<span class="nc" id="L457">             colNames.add(colName);</span>
         }
<span class="nc" id="L459">         return colNames;</span>
     }
     
     /**
      * To give border bottom to specified row (usually last row).
      * @param wb the workbook.
      * @param intSheet	thw worksheet.
      * @param intRow the last row.
      */
     @SuppressWarnings(&quot;deprecation&quot;)
	public static void lastRow(HSSFWorkbook wb, int intSheet, int intRow) {
<span class="nc" id="L470">         HSSFRow row = wb.getSheetAt(intSheet).getRow(intRow);</span>
<span class="nc bnc" id="L471" title="All 2 branches missed.">         for (short i=0; i&lt;row.getLastCellNum()-2; i++) {</span>
             try {
<span class="nc" id="L473">                 HSSFCellStyle oldStyle = row.getCell(i).getCellStyle();</span>
<span class="nc" id="L474">                 HSSFCellStyle newStyle = wb.createCellStyle();</span>
<span class="nc" id="L475">                 newStyle.setAlignment(oldStyle.getAlignment());</span>
<span class="nc" id="L476">                 newStyle.setBorderLeft(oldStyle.getBorderLeft());</span>
<span class="nc" id="L477">                 newStyle.setBorderRight(oldStyle.getBorderRight());</span>
<span class="nc" id="L478">                 newStyle.setDataFormat(oldStyle.getDataFormat());</span>
<span class="nc" id="L479">                 newStyle.setFont(wb.getFontAt(oldStyle.getFontIndex()));</span>
<span class="nc" id="L480">                 newStyle.setBorderBottom(HSSFCellStyle.BORDER_MEDIUM);</span>
<span class="nc" id="L481">                 row.getCell(i).setCellStyle(newStyle);</span>
<span class="nc" id="L482">             } catch(NullPointerException npe) {}</span>
         }
<span class="nc" id="L484">     }</span>
     
     /**
      * To give border bottom to specified row (usually last row).
      * @param wb the workbook.
      * @param intRow the last row.
      */
     @SuppressWarnings(&quot;deprecation&quot;)
	public static void lastRow(HSSFWorkbook wb, int intRow) {
<span class="nc" id="L493">         HSSFRow row = wb.getSheetAt(0).getRow(intRow);</span>
<span class="nc bnc" id="L494" title="All 2 branches missed.">         for (short i=0; i&lt;row.getLastCellNum()-2; i++) {</span>
             try {
<span class="nc" id="L496">                 HSSFCellStyle oldStyle = row.getCell(i).getCellStyle();</span>
<span class="nc" id="L497">                 HSSFCellStyle newStyle = wb.createCellStyle();</span>
<span class="nc" id="L498">                 newStyle.setAlignment(oldStyle.getAlignment());</span>
<span class="nc" id="L499">                 newStyle.setBorderLeft(oldStyle.getBorderLeft());</span>
<span class="nc" id="L500">                 newStyle.setBorderRight(oldStyle.getBorderRight());</span>
<span class="nc" id="L501">                 newStyle.setDataFormat(oldStyle.getDataFormat());</span>
<span class="nc" id="L502">                 newStyle.setFont(wb.getFontAt(oldStyle.getFontIndex()));</span>
<span class="nc" id="L503">                 newStyle.setBorderBottom(HSSFCellStyle.BORDER_MEDIUM);</span>
<span class="nc" id="L504">                 row.getCell(i).setCellStyle(newStyle);</span>
<span class="nc" id="L505">             } catch(NullPointerException npe) {}</span>
         }
<span class="nc" id="L507">     }</span>
     
     /**
      * To give border bottom to specified row (usually last row).
      * @param row the last row.
      */
     @SuppressWarnings(&quot;deprecation&quot;)
	public static void lastRow(HSSFRow row) {
<span class="nc bnc" id="L515" title="All 2 branches missed.">         for (short i=0; i&lt;row.getLastCellNum(); i++) {</span>
             try {
<span class="nc" id="L517">                 HSSFCellStyle style = row.getCell(i).getCellStyle();</span>
<span class="nc" id="L518">                 style.setBorderBottom(HSSFCellStyle.BORDER_MEDIUM);</span>
<span class="nc" id="L519">                 row.getCell(i).setCellStyle(style);</span>
<span class="nc" id="L520">             } catch(NullPointerException npe) {}</span>
         }
<span class="nc" id="L522">     }</span>

     /**
      * To copy format (style) of a row.
      * @param rowSource the source row.
      * @param rowDest	the destination row.
      */
     public static void copyFormat(HSSFRow rowSource, HSSFRow rowDest) {
<span class="nc" id="L530">         rowDest.setHeight(rowSource.getHeight());</span>
<span class="nc bnc" id="L531" title="All 2 branches missed.">         for (short i=0; i&lt;rowSource.getLastCellNum(); i++) {</span>
             try {
<span class="nc" id="L533">                 rowDest.getCell(i).setCellStyle(rowSource.getCell(i).getCellStyle());</span>
<span class="nc" id="L534">             } catch(NullPointerException npe) {}</span>
         }
<span class="nc" id="L536">     }</span>
     
     /**
      * To copy format (style) of a row.
      * @param rowSource the source row.
      * @param rowDest	the destination row.
      */
     public static void copyFormatCell(HSSFSheet sheet, int rowSource,int colSource, int rowDest, int colDest) {
            try {
<span class="nc" id="L545">            	HSSFRow rowResource  = getRow(sheet, rowSource);</span>
<span class="nc" id="L546">            	HSSFRow rowDestination  = getRow(sheet, rowDest);</span>
<span class="nc" id="L547">            	copyFormatCell(getCell(rowResource, colSource), getCell(rowDestination, colDest));</span>
<span class="nc" id="L548">             } catch(NullPointerException npe) {}</span>
<span class="nc" id="L549">     }</span>
     /**
      * To copy format (style) of a row.
      * @param rowSource the source row.
      * @param rowDest	the destination row.
      */
     public static void copyFormatCell(HSSFCell cellSource, HSSFCell cellDest) {
            try {
<span class="nc" id="L557">            	 cellDest.setCellStyle(cellSource.getCellStyle());</span>
<span class="nc" id="L558">             } catch(NullPointerException npe) {}</span>
<span class="nc" id="L559">     }</span>
    

     /**
      * To get the specified row.
      * @param sheet the worksheet.
      * @param intRow the specified row index.
      * @return the specified HSSFRow.
      */
     public static HSSFRow getRow(HSSFSheet sheet, int intRow) {
<span class="nc" id="L569">         HSSFRow row = sheet.getRow(intRow);</span>
<span class="nc bnc" id="L570" title="All 2 branches missed.">         if (row==null) row = sheet.createRow(intRow);</span>
<span class="nc" id="L571">         return row;</span>
     }

     /**
      * To get the specified cell.
      * @param row the row.
      * @param intCol the column.
      * @return the specified HSSFCell.
      */
     public static HSSFCell getCell(HSSFRow row, int intCol) {
<span class="nc" id="L581">         HSSFCell cell = row.getCell((short)intCol);</span>
<span class="nc bnc" id="L582" title="All 2 branches missed.">         if (cell==null) cell = row.createCell((short)intCol);</span>
<span class="nc" id="L583">         return cell;</span>
     }
     
     /**
      * Delete several rows.
      * @param sheet the worksheet.
      * @param from index of starting row to be deleted.
      * @param count number of row to be deleted.
      */
     public static void deleteRow(HSSFSheet sheet, int from, int count) {
<span class="nc" id="L593">         deleteRow(sheet, from, count, false);</span>
<span class="nc" id="L594">     }</span>
     
     /**
      * Delete several rows, and replace the deleted row with the new row.
      * @param sheet the worksheet.
      * @param from index of starting row to be deleted.
      * @param count number of row to be deleted.
      * @param blSameHeight flag whether the new row will have the same height.
      */
     public static void deleteRow(HSSFSheet sheet, int from, int count, boolean blSameHeight) {
<span class="nc bnc" id="L604" title="All 2 branches missed."> 		for (int i=from+count; i&lt;=sheet.getLastRowNum(); i++) {</span>
<span class="nc" id="L605">			copyRow(sheet,i,from++, blSameHeight);</span>
         }
<span class="nc bnc" id="L607" title="All 2 branches missed."> 		for ( ; from&lt;=sheet.getLastRowNum(); from++) {</span>
<span class="nc" id="L608"> 			HSSFRow rowDelete = sheet.getRow(from);</span>
<span class="nc bnc" id="L609" title="All 2 branches missed."> 			if (rowDelete!=null) sheet.removeRow(rowDelete);</span>
 		}
<span class="nc" id="L611"> 	 }</span>

     /**
      * Merge several cells.
      * @param sheet the worksheet.
      * @param rowFrom starting row.
      * @param colFrom starting column.
      * @param rowTo ending row.
      * @param colTo ending column.
      */
     /*public static void mergeCells(HSSFSheet sheet, int rowFrom, int colFrom, int rowTo, int colTo) {
         sheet.addMergedRegion(new Region(rowFrom, (short) colFrom, rowTo, (short) colTo));
     }*/    
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.3.201901230119</span></div></body></html>